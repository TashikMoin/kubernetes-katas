# Your AKS Cluster will need to live in the same or peered virtual networks as the NFS Server. 
# The cluster must be created in an existing VNET, which can be the same VNET as your VM.

sudo pacman -S nfs-utils

sudo systemctl enable nfs-utils
sudo systemctl start nfs-utils

sudo mkdir -p /srv/nfs/kubernetes-data
sudo chmod -R +777 /srv/nfs


# You can create an NFS export to make file system paths on your storage system available for 
# mounting by NFS clients. NFS clients can mount resources only after the resources have been 
# exported and made available for mounting.


# nano vi /etc/exports  
# add the following line after "use export -arv..",
# /srv/nfs/kubernetes-data   *(rw,sync,no_subtree_check,insecure)
# this means give access of this directory to any machine(*) with read,write etc previlges.


sudo exportfs -rav


# Now any node in the world can mount this nfs server exported directory we can check if
# the nodes are able to mount the exported directory or not using the following command,


# NOTE: Execute these commands on nodes in which we want to mount this exported nfs server directory.
# mount -f nfs <nfs server ip>:<nfs server exported directory> <node directory in which we want nfs server directory to be mounted>
# to confirm the mounting execute --> mount | grep <nfs server exported directory>



# To unmount the mounted directory, execute the following command on the nodes on which the nfs
# server exported directory was mounted,
# unmount <path to mounted directory of worker node>